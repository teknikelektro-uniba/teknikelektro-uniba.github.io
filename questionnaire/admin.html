<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="theme-color" content="#343a40">
  <meta name="msapplication-navbutton-color" content="#343a40">
  <meta name="apple-mobile-web-app-status-bar-style" content="#343a40">
  <meta name="programmer" content="https://github.com/ardirjs">
  <meta name="description" content="https://github.com/ardirjs">
  <meta name="keywords" content="https://github.com/ardirjs">
  <meta name="author" content="https://github.com/ardirjs">
  <meta name="title" content="https://github.com/ardirjs">
  <meta name="copyright" content="https://github.com/ardirjs">
  <meta Http-Equiv="Expires" content="0">
  <meta Http-Equiv="Pragma" content="No-Cache">
  <meta Http-Equiv="Content-type" content="Text/Html">
  <meta Http-Equiv="Cache-Control" content="No-Cache">
  <meta Http-Equiv="Cache-Control" content="No-Store">
  <meta Http-Equiv="Content-Language" content="En-Us">
  <meta Http-Equiv="X-UA-Compatible" content="IE=Edge">
  <link href="../asset/icon/uniba.png" rel="shortcut icon">
  <link href="../asset/icon/uniba.png" rel="apple-touch-icon">
  <link href="../asset/icon/uniba.png" rel="apple-touch-icon-precomposed">
  <title>Admin</title>
  <link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../bower_components/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="../asset/style/custom-bootstrap-admin.css">
</head>
<body class="bg-light">

  <!--[ ############################# header ############################## ]-->

  <div class="jumbotron py-5 mb-0 bg-dark rounded-0 border-bottom border-light">
    <div class="container">
      <a class="text-light font-weight-bolder nav-link px-0" href="https://teknikelektro.unibabwi.ac.id/">
        <div class="row align-items-center">
          <div class="pr-2 col-auto mb-2">
            <img src="../asset/icon/uniba.png" alt="uniba">
          </div>
          <div class="col-auto py-2 mb-2">
            <span class="text-light font-weight-bolder h3"><u>TEKNIK ELEKTRO</u></span><br>
            <span class="text-light font-weight-bolder h5">Fakultas Teknik - Universitas PGRI Banyuwangi</span>
          </div>
        </div>
      </a>
    </div>
  </div>

  <div class="bg-dark mb-4 shadow">
    <div class="container">
      <div class="d-flex justify-content-center">
        <div class="py-3 auto">
          <h4 class="font-weight-bolder text-light text-center">Admin</h4>
        </div>
      </div>
    </div>
  </div>

  <!--[ ############################# end header ########################## ]-->

  <div class="container mb-4">
    <div class="bg-dark shadow rounded">
      <div class="row py-2 px-4">
        <div class="col-auto p-1">
          <div class="dropdown">
            <button class="btn btn-dark border border-light dropdown-toggle" type="button" id="dropdownMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Pilih Data Ditampilkan
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenu">
              <a class="dropdown-item btn" id="angketkepuasanmahasiswaterhadappelayananakademik">Angket Kepuasan Mahasiswa Terhadap Pelayanan Akademik</a>
              <a class="dropdown-item btn" id="angketkepuasanmahasiswaterhadappelayananperpustakaan">Angket Kepuasan Mahasiswa Terhadap Pelayanan Perpustakaan</a>
              <a class="dropdown-item btn" id="angketkepuasanpelayanankeuangan">Angket Kepuasan Pelayanan Keuangan</a>
              <a class="dropdown-item btn" id="angketkepuasanpenggunalulusan">Angket Kepuasan Pengguna Lulusan</a>
              <a class="dropdown-item btn" id="angketkuesionerumpanbalikmitrakerjasama">Angket Kuesioner Umpan Balik Mitra Kerjasama</a>
              <a class="dropdown-item btn" id="formulirbiodatamahasiswa">Formulir Biodata Mahasiswa</a>
              <a class="dropdown-item btn" id="formulirkuesioneralumni">Formulir Kuesioner Alumni</a>
              <a class="dropdown-item btn" id="formulirpendaftaranmahasiswabaru">Formulir Pendaftaran Mahasiswa Baru</a>
            </div>
          </div>
        </div>
        <div class="col-auto p-1">
          <button class="btn btn-dark border border-light" type="button" id="refresh">Refresh</button>
        </div>
        <div class="col-auto p-1">
          <button class="btn btn-dark border border-light" type="button" id="export-csv">Export CSV</button>
        </div>
      </div>
    </div>
  </div>

  <div class="container mb-4">
    <h5 class="font-weight-bolder underline-prepend" id="header-dropdown">Belum Ada Data Dipilih</h5>
    <hr class="underline">
    <div class="mb-3"></div>
    <div id="not-found" class="show">
      <div class="bg-dark card shadow-sm border border-dark">
        <div class="card-body">
          <span class="text-light">Data tidak ditemukan</span>
        </div>
      </div>
    </div>
    <table id="table-data" class="table table-dark table-hover hidden">
      <thead><tr id="thead"></tr></thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

  <!--------------------------------------------------------------------------->
  <!--[ modal ]---------------------------------------------------------------->
  <!--[ login panel ]-->
  <div class="modal fade" id="modalLogin" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-body">
          <h4 class="font-weight-bolder underline-prepend">Login</h4>
          <hr class="underline">
          <input class="form-control shadow-none mb-2" type="text" id="username" placeholder="Username">
          <input class="form-control shadow-none mb-2" type="text" id="password" placeholder="Password">
          <button class="btn btn-dark btn-block shadow-none" type="button" id="login">
            <span><i class="fa fa-sign-in" aria-hidden="true"></i>&emsp;Login</span>
          </button>
        </div>
      </div>
    </div>
  </div>
  <!--[ loading panel ]-->
  <div class="modal fade" id="modalLoading" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-body">
          <div class="text-center">
            <div class="d-flex justify-content-center my-4" id="logLoading">
              <div class="pr-3 auto"><div class="spinner-border spinner-border"></div></div>
              <div class="p auto mt-1"><span class="font-weight-bolder">Sedang memuat ...</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--[ end modal ]------------------------------------------------------------>
  <!--------------------------------------------------------------------------->

  <!--[ ############################# footer ############################## ]-->

  <div class="bg-dark shadow border-bottom border-light">
    <div class="container-fluid">
      <div class="row py-4">
        <div class="col-sm-6 col-md-4 col-lg-3 mt-3">
          <h5 class="font-weight-bolder underline-prepend-light text-light ml-3">TEMUKAN KAMI</h5>
          <hr class="underline-light ml-3">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://web.facebook.com/people/Himatro-Uniba/100014736218778"><i class="fa fa-facebook-square" aria-hidden="true"></i>&emsp;FACEBOOK</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://www.instagram.com/himatro_uniba/"><i class="fa fa-instagram" aria-hidden="true"></i>&emsp;INSTAGRAM</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://www.youtube.com/channel/UCGB8WqgPXjWc9JZygR4T0fQ/"><i class="fa fa-youtube-play" aria-hidden="true"></i>&emsp;YOUTUBE</a></li>
          </ul>
        </div>
        <div class="col-sm-6 col-md-4 col-lg-3 mt-3">
          <h5 class="font-weight-bolder underline-prepend-light text-light ml-3">LAYANAN INFORMASI</h5>
          <hr class="underline-light ml-3">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://dosen.unibabwi.ac.id/login.php">SIM DOSEN</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://akademik.unibabwi.ac.id/login.php">SIM AKADEMIK</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://sim.unibabwi.ac.id/login.php">SIM MAHASISWA</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://sister.unibabwi.ac.id/auth/login">SISTER UNIBA Banyuwangi</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://unibabwi.ac.id/">Situs Resmi UNIBA Banyuwangi</a></li>
          </ul>
        </div>
        <div class="col-sm-6 col-md-4 col-lg-3 mt-3">
          <h5 class="font-weight-bolder underline-prepend-light text-light ml-3">TAUTAN PENTING</h5>
          <hr class="underline-light ml-3">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://ristekdikti.go.id/">KEMENRISTEK</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="http://simlitabmas.ristekdikti.go.id/">SIMLITABMAS</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://simbelmawa.ristekdikti.go.id/portal/">SIMBELMAWA</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://forlap.ristekdikti.go.id/">FORLAP DIKTI</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="http://www.kopertis7.go.id/">LLDIKTI Wilayah VII</a></li>
          </ul>
        </div>
        <div class="col-sm-6 col-md-4 col-lg-3 mt-3">
          <h5 class="font-weight-bolder underline-prepend-light text-light ml-3">HUBUNGI KAMI</h5>
          <hr class="underline-light ml-3">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="tel:6285649757429">NO. TELP/HP : +6285649757429</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="mailto:teknikelektro@unibabwi.ac.id">EMAIL : teknikelektro@unibabwi.ac.id</a></li>
            <li class="nav-item"><a class="nav-link text-light py-0 small" target="_blank" href="https://teknikelektro.unibabwi.ac.id/admin/">ADMIN</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-dark shadow">
    <div class="container">
      <div class="d-flex justify-content-end">
        <div class="py-3 auto">
          <a class="nav-link text-light p-0 shadow-sm" href="">&copy;2020 Teknik Elektro - Universitas PGRI Banyuwangi</a>
        </div>
      </div>
    </div>
  </div>

  <!--[ ############################# end footer ########################## ]-->

  <script src="../bower_components/jquery/dist/jquery.min.js" charset="utf-8"></script>
  <script src="../bower_components/popper/dist/umd/popper.js" charset="utf-8"></script>
  <script src="../bower_components/bootstrap/dist/js/bootstrap.min.js" charset="utf-8"></script>
  <script src="../bower_components/firebase/firebase-app.js" charset="utf-8"></script>
  <script src="../bower_components/firebase/firebase-auth.js" charset="utf-8"></script>
  <script src="../bower_components/firebase/firebase-database.js" charset="utf-8"></script>
  <script src="../bower_components/firebase/firebase-analytics.js" charset="utf-8"></script>
  <script src="../asset/script/export-csv.js" charset="utf-8"></script>
  <script type="text/javascript">
    $(document).ready(function() {

      var link, startGetData = false;
      var startThead = false, getDataThead;
      var startTbody = false, getDataTbody = [];

      /* secret database */
      var firebaseConfig = {
        apiKey: "AIzaSyDjhd5f9Iu2B49nocF_Fpm1qlz5ShdyRRs",
        authDomain: "databaseteknikelektro.firebaseapp.com",
        databaseURL: "https://databaseteknikelektro.firebaseio.com",
        projectId: "databaseteknikelektro",
        storageBucket: "databaseteknikelektro.appspot.com",
        messagingSenderId: "511683152914",
        appId: "1:511683152914:web:4d317cf5e0bb5a40ee1ccb",
        measurementId: "G-95NP9ZB5DH"
      };
      /* initialize firebase */
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
      /* modals login page */
      $("#modalLogin").modal({modal: "show", backdrop: "static"});
      /* jQuery */
      $(document).ready(function() {
        setInterval(function() {
          //location.reload();
        }, 5000);
      });

      $('#login').click(function() {
        $("#modalLogin").modal("hide");
        $("#modalLoading").modal({modal: "show", backdrop: "static"});
        firebase.auth().signInWithEmailAndPassword(
          $('#username').val(),
          $('#password').val()
        )
        .then(function(result) {
          $("#modalLoading").modal("hide");
          setTimeout(function() {
            $("#thead").html("");
            $("#tbody").html("");
            startGetData = true;
            $("#header-dropdown").html("Angket Kepuasan Mahasiswa Terhadap Pelayanan Akademik");
            link = "angket-kepuasan-mahasiswa-terhadap-pelayanan-akademik";
          }, 1000);
        })
        .catch(function(error) {
          $("#logLoading").html('<span><b>Mohon maaf, username atau password yang anda masukkan salah</b></span>');
          setTimeout(function() {
            location.reload();
          }, 3000);
        });
      });

      $("#angketkepuasanmahasiswaterhadappelayananakademik").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "angket-kepuasan-mahasiswa-terhadap-pelayanan-akademik";
      });
      $("#angketkepuasanmahasiswaterhadappelayananperpustakaan").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "angket-kepuasan-mahasiswa-terhadap-pelayanan-perpustakaan";
      });
      $("#angketkepuasanpelayanankeuangan").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "angket-kepuasan-mahasiswa-terhadap-pelayanan-keuangan";
      });
      $("#angketkepuasanpenggunalulusan").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "angket-kepuasan-pengguna-lulusan-program-studi-teknik-elektro";
      });
      $("#angketkuesionerumpanbalikmitrakerjasama").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "angket-kuesioner-umpan-balik-mitra-kerjasama";
      });
      $("#formulirbiodatamahasiswa").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "formulir-biodata-mahasiswa";
      });
      $("#formulirkuesioneralumni").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "formulir-kuesioner-alumni";
      });
      $("#formulirpendaftaranmahasiswabaru").click(function() {
        $("#thead").html("");
        $("#tbody").html("");
        startGetData = true;
        $("#header-dropdown").html($(this).html());
        link = "formulir-pendaftaran-mahasiswa-baru";
      });

      $("#refresh").click(function() {
        if ($("#not-found").attr("class") == "hidden") {
          $("#thead").html("");
          $("#tbody").html("");
          startGetData = true;
        }
      });

      setInterval(function() {
        if (startGetData) {
          $("#modalLoading").modal({modal: "show", backdrop: "static"});
          $("#not-found").removeClass("hidden").addClass("show");
          $("#table-data").removeClass("show").addClass("hidden");
          getDataThead = 0; getDataTbody = [];
          firebase.database().ref().child(link + '/question').once('value', function(snapshot) {
            getDataThead = snapshot.val();
            startThead = true;
          });
          firebase.database().ref().child(link + '/data').once('value', function(snapshot) {
            snapshot.forEach(function(childSnapshot) {
              getDataTbody.push(childSnapshot.val());
              startTbody = true;
            })
          });
        }
        startGetData = false;

        if (startThead) {
          $("#thead").append('<th>No.</th>');
          for (var i = 0; i <= 3; i++) {$("#thead").append('<th>' + getDataThead["QA" + i] + '</th>');}
          setTimeout(function() {
            $("#modalLoading").modal("hide");
          }, 1000);
          startThead = false;
        }
        if (startTbody) {
          $("#not-found").removeClass("show").addClass("hidden");
          $("#table-data").removeClass("hidden").addClass("show");
          for (var i = 0; getDataTbody[i] != undefined; i++) {
            var tdElement = "";
            tdElement = tdElement + '<td>' + (i + 1) + '</td>';
            for (var j = 0; j <= 3; j++) {tdElement = tdElement + '<td>' + getDataTbody[i]["QA" + j] + '</td>';}
            $("#tbody").append('<tr>' + tdElement + '</tr>');
          }
          startTbody = false;
        }
      });
      /*----------------------------------------------------------------------*/
      $("#export-csv").click(function() {
        var string = JSON.stringify(getDataThead), str = "";
        for (var i = 0; i < string.length; i++) {
          if (string[i] + string[i + 1] == "\",") {
            str += "~";
            i ++;
          } else if (string[i] + string[i + 1] == "},") {
            str += "^";
            i ++;
          } else {
            str += string[i];
          }
        }
        string = "";
        for (var i = 0; i < str.length; i++) {
          if (str[i] == ",") {
            string += "#";
          } else if (str[i] == "~") {
            string += "\",";
          } else if (str[i] == "^") {
            string += "},";
          } else {
            string += str[i];
          }
        }
        var headerJson = JSON.parse(string);
        var string = JSON.stringify(getDataTbody), str = "";
        for (var i = 0; i < string.length; i++) {
          if (string[i] + string[i + 1] == "\",") {
            str += "~";
            i ++;
          } else if (string[i] + string[i + 1] == "},") {
            str += "^";
            i ++;
          } else {
            str += string[i];
          }
        }
        string = "";
        for (var i = 0; i < str.length; i++) {
          if (str[i] == ",") {
            string += "#";
          } else if (str[i] == "~") {
            string += "\",";
          } else if (str[i] == "^") {
            string += "},";
          } else {
            string += str[i];
          }
        }
        var dataJson = JSON.parse(string);
        var titleCsv = $("#header-dropdown").html();
        exportCSVFile(headerJson, dataJson, titleCsv);
      });
    });
  </script>
</body>
</html>
